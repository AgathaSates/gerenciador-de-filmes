import"./chunk-MCSP4SFB.js";import{a as z}from"./chunk-KX4KH4NX.js";import{a as V}from"./chunk-YTZZOMT2.js";import{Ba as I,D as n,G as N,M as v,N as h,O as $,P as A,Q as F,R as o,S as s,T as P,X as q,Z as O,_ as c,aa as d,c as b,ca as j,da as B,e as u,f as y,h as C,ha as _,i as x,ia as f,j as L,ja as M,k as S,l as k,m as w,n as R,na as p,oa as m,t as g,u as T,v as E,va as D}from"./chunk-BQQJ7R74.js";var W=(i,t)=>t.id;function G(i,t){if(i&1&&(o(0,"div",4)(1,"p",6),d(2),s()()),i&2){c();let e=M(1);n(2),j('Nenhum resultado encontrado para "',e,'".')}}function H(i,t){if(i&1&&(o(0,"div",7),P(1,"card-movie",8),s()),i&2){let e=t.$implicit;n(),F("media",e)}}function J(i,t){if(i&1&&$(0,H,2,1,"div",7,W),i&2){c();let e=M(7);A(e==null?null:e.results)}}function K(i,t){if(i&1){let e=q();o(0,"div",5)(1,"button",9),O("click",function(){T(e);let l=c();return E(l.loadMore())}),P(2,"i",10),d(3," Carregar mais "),s()()}}var U=class i{activatedRoute=g(I);mediaService=g(V);searchTerm$=this.activatedRoute.queryParamMap.pipe(u(t=>(t.get("q")??"").trim()),x());loadMoreClick$=new b;currentPage=1;endPage=!1;sectionTitle=this.activatedRoute.paramMap.pipe(u(t=>{switch(t.get("category")){case"popular":return"Filmes Populares";case"top-rated":return"Filmes Melhores avaliados";case"now-playing":return"Filmes Em cartaz";case"search":return"Resultados da busca por: ";default:return"Filmes Populares"}}));contentList=y([this.activatedRoute.paramMap,this.activatedRoute.queryParamMap]).pipe(w(([t,e])=>{let a=t.get("category"),l=(e.get("q")??"").trim();switch(a){case"popular":return this.makePager(r=>this.mediaService.selectPopularMovieMedia(r));case"top-rated":return this.makePager(r=>this.mediaService.selectTopRatedMovieMedia(r));case"now-playing":return this.makePager(r=>this.mediaService.selectNowPlayingMovieMedia(r));case"search":return this.makePager(r=>this.mediaService.searchMovieMedia(l,r));default:return this.makePager(r=>this.mediaService.selectPopularMovieMedia(r))}}));makePager(t){return this.currentPage=1,this.endPage=!1,this.loadMoreClick$.pipe(k(void 0),C(()=>!this.endPage),L(()=>t(this.currentPage).pipe(R(e=>{this.endPage=e.page>=e.total_pages,this.currentPage+=1}))),S((e,a)=>({page:a.page,total_pages:a.total_pages,total_results:a.total_results,results:[...e.results,...a.results]}),{page:0,total_pages:0,total_results:0,results:[]}))}loadMore(){this.loadMoreClick$.next()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=N({type:i,selectors:[["list-page"]],decls:13,vars:12,consts:[[1,"px-5","py-4"],[1,"text-center"],[1,"fs-1","gradient-title"],[1,"row","g-3","mt-1","px-1"],[1,"col-12"],[1,"d-flex","justify-content-center","my-4"],[1,"text-center","fs-4"],[1,"col-lg-3","col-xl-2","pb-3"],[3,"media"],[1,"btn","btn-secondary",3,"click"],[1,"bi","bi-arrow-clockwise","my-auto","me-1"]],template:function(e,a){if(e&1&&(o(0,"div",0),_(1),p(2,"async"),o(3,"div",1)(4,"h2",2),d(5),p(6,"async"),s()(),_(7),p(8,"async"),o(9,"div",3),v(10,G,3,1,"div",4)(11,J,2,0),s(),v(12,K,4,0,"div",5),s()),e&2){n();let l=f(m(2,4,a.searchTerm$));n(4),B("",m(6,7,a.sectionTitle)," ",l),n(2);let r=f(m(8,9,a.contentList));n(3),h((r==null?null:r.total_results)===0?10:11),n(2),h(a.endPage?-1:12)}},dependencies:[z,D],encapsulation:2})};export{U as ListPage};
